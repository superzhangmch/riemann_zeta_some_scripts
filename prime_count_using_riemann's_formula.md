# 黎曼的素数计数公式 —— 精确计数公式

黎曼研究 zeta(s), 目的是给出小于 x 的素数个数公式 $\pi(x)$。不同于别人的近似公式，他的公式是精确的：

$$\begin{align}
J(x) &= \text{Li}(x) - \sum_{Im(\rho)>0} [\text{Li}(x^{\rho}+\text{Li}(x^{1-\rho})] + \int_x^\infty \frac {dt} {t(t^2-1) \ln t} - \ln 2 \\
\pi(x) &= \sum_n \frac {\mu(n)} n J(x^{1/n}) \\
\end{align}$$

$\mu(n)$ 是莫比乌斯函数， { $\rho$ } 是按虚部大于 0 且升序的 zeta(s) 零点集合。

上式有一个近似形式， $\pi(x) ≈ \sum_{n=1}^\infty \frac {\mu(n)} n \cdot (Li(x^{1/n})-\sum_\rho [Li(x^{\frac {\rho} n})+]Li(x^{\frac {1-\rho} n})) - \frac 1 {\log(x)} + \frac 1 {\pi} \arctan(\frac {\pi} {\log(x)})$ 。

把求和项中只剩下 Li(.), 则： $\pi(x) ≈ \sum_{n=1}^\infty \frac {\mu(n)} n Li(x^{\frac 1 n}) = 1+\sum_{n=1} \frac {\log^n(x)} {n \cdot n! \cdot \zeta(n+1)}$.

而还有近似式： $\pi(x) ≈ Li(x)$, 以及 $\pi(x) ≈ \frac x {\ln(x)}$. 

把它们[代码](https://github.com/superzhangmch/riemann_zeta_some_scripts/blob/main/prime_count_using_riemann's_formula.py)【需要注意因 log 为多值函数 $Li(x^{\rho/n})$ 得用 $Ei[log(x) \frac {\rho} n]$ 才行】验证。比较下, 可以得到:

| 截止 | $\pi(x)$ | 精确公式 | 精确公式之近似 | $\sum_n \frac {\mu(n)} n Li(x^{\frac 1 n})$ | $1+\sum_n \frac {\log^n(x)} {n \cdot n! \cdot \zeta(n+1)}$ | Li(x)| $\frac x {\log(x)}$ |
|----|----|----|----|----|----|----|----|
|10e1|4|0|1|0|0|2|0|
|10e2|25|0|1|0|0|5|4|
|10e3|168|0|1|0|0|9|24|
|10e4|1229|0|0|3|3|17|144|
|10e5|9592|1|1|5|5|37|907|
|10e6|78498|4|4|29|29|129|6116|
|10e7|664579|7|7|88|88|339|44159|
|10e8|5761455|7|7|96|96|754|332774|
|10e9|50847534|16|16|79|79|1700|2592592|
|10e10|455052511|188|188|1828|1828|3103|20758030|
|10e11|4118054813|587|587|2319|2319|11587|169923160|
|10e12|37607912018|926|926|1476|1476|38262|1416705193|
|10e13|346065536839|1357|1357|5774|5774|108971|11992858452|
|10e14|3204941750802|26170|26170|19201|19201|314889|102838308636|
|10e15|29844570422669|30945|30945|73217|73217|1052618|891604962453|
|10e16|279238341033925|45410|45410|327052|327053|3214632|7804289844393|
|10e17|2623557157654233|323360|323360|598255|598253|7956590|68883734693928|
|10e18|24739954287740860|773152|773152|3501392|3501408|21949524|612483070893536|
|10e19|234057667276344607|3175041|3175041|23885089|23884993|99878497|5481624169369983|

可见 Riemann 的精确公式确实很准（如果用更多零点参与计算，可以更准）。

但是，对于不是特别巨大的数(10e17, 也不过1.34s)，竟然有算法（比如[github:primecount](https://github.com/kimwalisch/primecount)）直接快速求出 $\pi(x)$ 的精确值，可比上面 Riemann 精确公式要快多了。
